namespace tests

  @suite("session.bs - Username Sanitization for URL-safe DeviceId")
  class SessionUsernameSanitizationTests extends tests.BaseTestSuite

    '+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
    @describe("user.SanitizeUsernameForUrl() - Pure function tests (no I/O)")
    '+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

    @it("removes spaces from username")
    function _()
      result = user.SanitizeUsernameForUrl("John Doe")
      m.assertEqual("JohnDoe", result)
    end function

    @it("removes special characters from username")
    function _()
      result = user.SanitizeUsernameForUrl("John.R.Doe!")
      m.assertEqual("JohnRDoe", result)
    end function

    @it("removes spaces and special chars from username")
    function _()
      result = user.SanitizeUsernameForUrl("Jane A. Doe")
      m.assertEqual("JaneADoe", result)
    end function

    @it("handles LDAP format names - issue #568")
    function _()
      result = user.SanitizeUsernameForUrl("John R. Doe")
      m.assertEqual("JohnRDoe", result)
    end function

    @it("handles empty string")
    function _()
      result = user.SanitizeUsernameForUrl("")
      m.assertEqual("", result)
    end function

    @it("handles username with only special chars")
    function _()
      result = user.SanitizeUsernameForUrl("!@#$   ")
      m.assertEqual("", result)
    end function

    @it("preserves alphanumeric usernames")
    function _()
      result = user.SanitizeUsernameForUrl("user123")
      m.assertEqual("user123", result)
    end function

    @it("preserves URL-safe chars (hyphens and underscores)")
    function _()
      result = user.SanitizeUsernameForUrl("user_name-test")
      m.assertEqual("user_name-test", result)
    end function

  end class

end namespace
